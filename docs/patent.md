## Система патентов

Необходима для подтверждения владения вами городов, структур, и т.д.


### Пути к модулям системы

- /bll/reducers/users/
- /modules/patent/
- /storage/patent/
- /ui/pages/patent/


### Необходимые требования
- Для регистации патента:
  - зарегестрировать своего персонажа в /storage/users/, если вас там нет


### Регистрация (создание) патента

#### Использование
Чтобы попасть на страницу системы патентов нужно ввести `рег ап`. Для создания патента введите через пробел свой `user_name` 
и выданный вам `user_hashpass`. На экран вам выведется промежуточный хеш (mw_hash). Cкопируйте его. Далее, в файле /storage/patent/
добавьте следующий код в функцию create_patents:

```python
create_patent_action(user_name, mw_hash, description)
```

где:
- user_name (str) - ваш user_name
- mw_hash (str) - скопированный ранее промежуточный хеш
- description (str) - содержание патента

####  Принцип работы (краткое описание)
После ввода требуемых данных проверяется их валидность с помощью функции `is_user_valid_action`. Валидность данных сохраняется в `state['users']['is_user_valid']`. Далее вычисляется mw_hash функцией `calculate_mw_hash_action` с помощью криптографической хеш-функции sha3-256, поставляемой библиотекой hashlib. Он зависит от user_name и user_hashpass

После того, как пользователь зарегестрировал патент в /storage/patent, в `state[user_name]['patent_chain']` добавляется так называемый блок (объект), содержащий:

- hash - хеш текущего блока
- previous_hash - хеш предыдущего блока
- desc - содержание патента

hash текущего блока вычисляется функцией `calculate_hash`. Он зависит от промежуточного хеша, хеша предыдущего блока и содержания патента.

Таким обрабом у нас получается блокчейн. Его корректность можно проверить, вызвав функцию `is_chain_valid_action` и выведя на экран `state[user_name]['is_chain_valid']`.


### Обработка ошибок
Если при вводе данных `user_name` нет в объекте users, или если `user_hashpass` неверный, то на экран выведется ошибка
"ERR: Неверные данные пользователя". Если же у вас неверный формат входных данных, выведется ошибка "ERR: Несуществующая команда или неверный формат входных данных".
При этом работоспособность системы не нарушится, ведь обработка ошибок присутствует и на слое BLL.